# Event Audit Dashboard Service

[![CI: Optimized Multi-arch Docker Builds for Python Services](https://github.com/jojees/project-genesis/actions/workflows/build-python-services.yml/badge.svg)](https://github.com/jojees/project-genesis/actions/workflows/build-python-services.yml)
[![Docker Image](https://img.shields.io/docker/pulls/jojees/event-audit-dashboard?label=Docker%20Pulls)](https://hub.docker.com/r/jojees/event-audit-dashboard)
[![License](https://img.shields.io/badge/License-MIT-blue.svg)](LICENSE)

---

## üöÄ Overview

The `event-audit-dashboard` service is the **frontend web application** for the AuditFlow Platform. Its core purpose is to provide a **user-friendly interface for visualizing audit alerts** generated by the system. It connects to the **Notification Service's API** to retrieve and display alert data, offering both a summary dashboard and detailed views for individual alerts.

---

## ‚ú® Features

* **Alert Visualization**: Presents a clear, real-time view of recent audit alerts on a dashboard.
* **Detailed Alert View**: Allows users to drill down into specific alerts to see comprehensive details, including raw event data and metadata.
* **Backend API Integration**: Consumes alert data directly from the `notification-service` via its RESTful API.
* **Simple & Intuitive UI**: Built with Flask and Jinja2 templates for a straightforward user experience.
* **Health Check**: Includes a `/healthz` endpoint for robust liveness and readiness probes in containerized environments.
* **Production-Ready**: Utilizes **Gunicorn** for serving the Flask application, ensuring stability and performance in production.

---

## üõ†Ô∏è Technologies Used

* **Python**: Primary development language.
* **Flask**: Web framework for building the application.
* **Requests**: HTTP library for communicating with the Notification Service.
* **Gunicorn**: Production-grade WSGI HTTP server.
* **Jinja2**: Templating engine for rendering HTML.

---

## ‚öôÔ∏è Configuration

The dashboard service is configured using environment variables:

| Environment Variable          | Default Value | Description                                                    |
| :---------------------------- | :------------ | :------------------------------------------------------------- |
| `NOTIFICATION_SERVICE_HOST`   | `localhost`   | Hostname or IP of the Notification Service.                    |
| `NOTIFICATION_SERVICE_PORT`   | `8000`        | Port on which the Notification Service API is exposed.         |
| `APP_PORT`                    | `8080`        | Port on which this dashboard application will listen. (Used by Gunicorn) |

---

## üöÄ Getting Started

These instructions will help you set up and run the `event-audit-dashboard` locally for development and testing.

### Prerequisites

* Python 3.12+
* Poetry (recommended for dependency management) or pip
* Access to a running **Notification Service** instance (local or remote).

### Local Development

1.  **Clone the repository:**
    ```bash
    git clone [https://github.com/jojees/project-genesis.git](https://github.com/jojees/project-genesis.git)
    cd project-genesis/src/event-audit-dashboard
    ```

2.  **Install dependencies (using Poetry):**
    ```bash
    poetry install
    ```
    (Alternatively, if using pip and `requirements.txt` is up-to-date):
    ```bash
    pip install -r requirements.txt
    ```

3.  **Configure Environment Variables:**
    Create a `.env` file in the `src/event-audit-dashboard` directory. Adjust `NOTIFICATION_SERVICE_HOST` and `NOTIFICATION_SERVICE_PORT` to point to your Notification Service instance.

    ```ini
    NOTIFICATION_SERVICE_HOST=localhost # or your Notification Service IP/hostname
    NOTIFICATION_SERVICE_PORT=8000      # default port for Notification Service API
    APP_PORT=8080
    ```

4.  **Run the application:**
    ```bash
    # If using Poetry (uses Gunicorn as per Dockerfile, or Flask dev server for simple testing):
    # To run with Flask dev server for easier debugging:
    poetry run python -m event_audit_dashboard.app
    # To run with Gunicorn (closer to production):
    # poetry run gunicorn --bind 0.0.0.0:8080 event_audit_dashboard.app:app
    ```
    The application will start on `http://localhost:8080`.

### Docker (Local Build and Run)

1.  **Navigate to the service directory:**
    ```bash
    cd project-genesis/src/event-audit-dashboard
    ```

2.  **Build the Docker image:**
    ```bash
    docker build -t jojees/event-audit-dashboard:local .
    ```

3.  **Run the Docker container:**
    Ensure your Notification Service is accessible from the Docker container. Use `--network host` (if suitable for your environment) or set `NOTIFICATION_SERVICE_HOST` to your host's IP if the Notification Service runs on the host.

    ```bash
    docker run -d \
      --name event-audit-dashboard \
      -p 8080:8080 \
      -e NOTIFICATION_SERVICE_HOST=host.docker.internal \ # Use host.docker.internal for Docker Desktop
      -e NOTIFICATION_SERVICE_PORT=8000 \
      jojees/event-audit-dashboard:local
    ```
    Replace `host.docker.internal` with the appropriate address to reach your Notification Service.

---

## ‚ò∏Ô∏è Kubernetes Deployment

This service is designed for deployment within a Kubernetes cluster. The base Kubernetes manifests are located in `k8s/base/event-audit-dashboard/`.

### Prerequisites for Kubernetes Deployment

* A running Kubernetes cluster.
* `kubectl` configured to connect to your cluster.
* A deployed **Notification Service** instance in your cluster, accessible via its Kubernetes Service name (e.g., `notification-service`).
* A Docker image of `event-audit-dashboard` pushed to a container registry. The project's CI pipeline automates this for Docker Hub.

### Deploying to Kubernetes

1.  **Ensure the Notification Service is running in your cluster.**
    This dashboard depends on it.

2.  **Apply the dashboard service manifests:**
    ```bash
    kubectl apply -f k8s/base/event-audit-dashboard/
    ```

3.  **Verify the deployment:**
    ```bash
    kubectl get pods -l app=event-audit-dashboard
    kubectl get service event-audit-dashboard-service
    ```

4.  **Access the dashboard:**
    Depending on your Kubernetes setup (LoadBalancer, NodePort, Ingress), you can access the dashboard via the exposed service IP/hostname and port (default 8080).

---

## üìà Monitoring

The `event-audit-dashboard` service provides a simple `/healthz` endpoint to report its operational status, which is crucial for Kubernetes liveness and readiness probes.

---

## üíª Developer Utilities & Maintenance

This section contains useful commands for local development, dependency management, and code quality checks for this service.

### Update `requirements.txt`
If you modify `pyproject.toml` (e.g., add/remove dependencies), ensure `requirements.txt` is updated to reflect those changes for Docker builds and consistent deployments:
```bash
poetry export -f requirements.txt --output requirements.txt --without-hashes
```

### Add Development Dependencies
To add a new dependency specifically for development (e.g., testing frameworks, linters), use Poetry's --group dev flag:
```bash
poetry add bandit --group dev
```

### Run Static Analysis (Bandit)
To perform static application security testing (SAST) using Bandit, run the following command. This helps identify common security issues in your Python code:
```bash
poetry run bandit -r . -ll -f json -o bandit_results.json
```

This command recursively scans the current directory, shows findings at low and medium confidence levels, outputs results in JSON format, and saves them to bandit_results.json.

---

## Rationale for this approach:

1.  **Direct Utility**: These commands are highly useful for anyone actively developing or maintaining the service.
2.  **Clear Categorization**: Grouping them under a dedicated heading makes their purpose clear and improves readability.
3.  **Contextual Explanation**: Adding a brief explanation for each command (e.g., *why* you'd run `poetry export` or `bandit`) provides helpful context for developers.
4.  **Actionable**: The commands are presented in clear code blocks, ready to be copied and executed.

By including these commands, the `README.md` becomes a more complete and valuable resource for developers interacting with the `event-audit-dashboard` service.










## üìñ Further Context

For more in-depth technical details, architectural considerations, and a comprehensive overview of the `event-audit-dashboard` service's internal workings, please refer to its dedicated context file:

* [src/event-audit-dashboard/CONTEXT.md](src/event-audit-dashboard/CONTEXT.md)

---

## ü§ù Contributing

We welcome contributions! Please see the [CONTRIBUTING.md](../../CONTRIBUTING.md) for guidelines.

---

## üìÑ License

This project is licensed under the MIT License - see the [LICENSE](../../LICENSE) file for details.

---

## üìû Contact

For questions or feedback, please open an issue in the [GitHub Issues](https://github.com/jojees/project-genesis/issues) section.
---